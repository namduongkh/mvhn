webpackJsonp([1],{578:function(module,exports,__webpack_require__){function injectStyle(ssrContext){__webpack_require__(698)}var Component=__webpack_require__(3)(__webpack_require__(700),__webpack_require__(707),injectStyle,"data-v-a7d1a59a",null);module.exports=Component.exports},594:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _extends2=__webpack_require__(7),_extends3=_interopRequireDefault(_extends2),_getPrototypeOf=__webpack_require__(256),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=__webpack_require__(28),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=__webpack_require__(38),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=__webpack_require__(257),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=__webpack_require__(258),_inherits3=_interopRequireDefault(_inherits2),_services=__webpack_require__(68),_services2=_interopRequireDefault(_services),_axios=__webpack_require__(27),_axios2=_interopRequireDefault(_axios),ResourcesService=function(_Service){function ResourcesService(){return(0,_classCallCheck3.default)(this,ResourcesService),(0,_possibleConstructorReturn3.default)(this,(ResourcesService.__proto__||(0,_getPrototypeOf2.default)(ResourcesService)).apply(this,arguments))}return(0,_inherits3.default)(ResourcesService,_Service),(0,_createClass3.default)(ResourcesService,[{key:"index",value:function(params){return this.getItems(params)}},{key:"new",value:function(){return this.newItem()}},{key:"edit",value:function(id){return this.getItemById(id)}},{key:"show",value:function(id){return this.getItemById(id)}},{key:"create",value:function(data){return this.addItem(data)}},{key:"update",value:function(id,data){return this.updateItem(id,data)}},{key:"delete",value:function(id){return this.deleteItem(id)}},{key:"member",value:function(actionName){var method=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GET",data=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},config=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return _axios2.default.request((0,_extends3.default)({url:this.apiBaseUrl+"/"+actionName,method:method,data:data,withCredentials:!0},config))}}]),ResourcesService}(_services2.default);exports.default=ResourcesService},698:function(module,exports,__webpack_require__){var content=__webpack_require__(699);"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);var add=__webpack_require__(19).default;add("10506c3a",content,!0,{})},699:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(!1),exports.push([module.i,"",""])},700:function(module,exports,__webpack_require__){"use strict";function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}Object.defineProperty(exports,"__esModule",{value:!0});var _defineProperty2=__webpack_require__(39),_defineProperty3=_interopRequireDefault(_defineProperty2),_extends2=__webpack_require__(7),_extends3=_interopRequireDefault(_extends2),_vuex=__webpack_require__(10),_fields=__webpack_require__(701),_resources_service=__webpack_require__(594),_resources_service2=_interopRequireDefault(_resources_service),_StoreOrderUpdater=__webpack_require__(702),_StoreOrderUpdater2=_interopRequireDefault(_StoreOrderUpdater);exports.default={name:"ListStoreOrder",data:function(){return{fieldsDisplay:_fields.fieldsDisplay,sortOrder:_fields.sortOrder,cmsUrl:window.settings.services.cmsUrl+"/store_orders",parentService:new _resources_service2.default(window.settings.services.cmsUrl+"/"+this.$route.params.parentType),parent:null,parentType:"stores"==this.$route.params.parentType?"store":"storeTable",moreParams:this.defaultFilter(),selectedOrder:null}},computed:(0,_extends3.default)({},(0,_vuex.mapGetters)(["filterData"])),components:{StoreOrderUpdater:_StoreOrderUpdater2.default},methods:(0,_extends3.default)({},(0,_vuex.mapActions)(["openConfirm","setParams","reloadTable"]),{goto:function(router){this.$store.dispatch("goto",router)},defaultFilter:function(){var _ref;return _ref={},(0,_defineProperty3.default)(_ref,this.parentType,this.parent&&this.parent._id),(0,_defineProperty3.default)(_ref,"orderStatus",{$nin:["ordering"]}),_ref},orderStatusUpdated:function(order){this.reloadTable(),this.selectedOrder=order}}),created:function(){var _this=this;this.$route.params.parentId&&this.parentService.show(this.$route.params.parentId).then(function(_ref2){var _this$setParams,data=_ref2.data;_this.parent=data,_this.setParams((_this$setParams={},(0,_defineProperty3.default)(_this$setParams,_this.parentType,_this.parent._id),(0,_defineProperty3.default)(_this$setParams,"orderStatus",{$nin:["ordering"]}),_this$setParams));for(var prop in _this.moreParams)_this.$route.query.hasOwnProperty(prop)&&_this.$route.query[prop]&&(_this.moreParams[prop]=_this.$route.query[prop]);_this.reloadTable()})},watch:{onResetParams:function(val){val&&(this.moreParams=this.defaultFilter())}}}},701:function(module,exports,__webpack_require__){"use strict";var _moment=__webpack_require__(0);!function(obj){obj&&obj.__esModule}(_moment);exports.fieldsDisplay=[{name:"orderName",titleClass:"text-center",title:"Đơn hàng",sortField:"orderName"},{name:"storeOrderItems",titleClass:"text-center",title:"Mặt hàng",callback:function(val){return val.map(function(item){return'<span class="badge">'+item.quantity+"</span> "+item.storeMenu.name+" ("+item.itemStatus+")"}).join("<br/>")}},{name:"total",titleClass:"text-center",title:"Tổng tiền",sortField:"total"},{name:"orderStatus",titleClass:"text-center",title:"Trạng thái",sortField:"orderStatus",callback:function(val){return{ordering:'<span class="label label-default">Đang chọn hàng</span>',ordered:'<span class="label label-primary">Đã đặt hàng</span>',active:'<span class="label label-success">Đang xử lý</span>',ready:'<span class="label label-info">Đã sẵn sàng</span>',delivering:'<span class="label label-success">Đang vận chuyển</span>',delivered:'<span class="label label-secondary">Đã vận chuyển</span>',done:'<span class="label label-default">Hoàn thành</span>',cancel:'<span class="label label-danger">Đã hủy bỏ</span>'}[val]}}],exports.sortOrder=[{field:"createdAt",direction:"desc"}]},702:function(module,exports,__webpack_require__){function injectStyle(ssrContext){__webpack_require__(703)}var Component=__webpack_require__(3)(__webpack_require__(705),__webpack_require__(706),injectStyle,null,null);module.exports=Component.exports},703:function(module,exports,__webpack_require__){var content=__webpack_require__(704);"string"==typeof content&&(content=[[module.i,content,""]]),content.locals&&(module.exports=content.locals);__webpack_require__(44)("7ec01fc2",content,!0,{})},704:function(module,exports,__webpack_require__){exports=module.exports=__webpack_require__(12)(!1),exports.push([module.i,"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",""])},705:function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var _resources_service=__webpack_require__(594),_resources_service2=function(obj){return obj&&obj.__esModule?obj:{default:obj}}(_resources_service);exports.default={name:"StoreOrderUpdater",props:{order:{type:Object,require:!0}},data:function(){return{service:new _resources_service2.default(window.settings.services.cmsUrl+"/store_orders"),cloneOrder:{}}},methods:{updateStatusTo:function(status){var _this=this;confirm("Are you sure to change the status to '"+status+"'")&&this.service.update(this.order._id,{orderStatus:status}).then(function(_ref){var data=_ref.data;_this.$notify("Updated!",{type:"success"}),_this.$emit("updated",data.data)})}}}},706:function(module,exports){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("div",{staticClass:"modal fade",attrs:{id:"update-modal",role:"dialog"}},[_c("div",{staticClass:"modal-dialog"},[_c("div",{staticClass:"modal-content"},[_c("div",{staticClass:"modal-body text-center"},[_c("button",{staticClass:"btn btn-primary-outline",attrs:{type:"button",disabled:"ordered"!=_vm.order.orderStatus},on:{click:function($event){return _vm.updateStatusTo("active")}}},[_c("i",{staticClass:"fa fa-check"}),_vm._v("\n            Nhận đơn\n          ")]),_vm._v(" "),_c("i",{staticClass:"fa fa-arrow-right"}),_vm._v("\n          Đang xử lý\n          "),_c("i",{staticClass:"fa fa-arrow-right"}),_vm._v(" "),_c("button",{staticClass:"btn btn-primary-outline",attrs:{type:"button",disabled:"ready"!=_vm.order.orderStatus},on:{click:function($event){return _vm.updateStatusTo("delivering")}}},[_c("i",{staticClass:"fa fa-check"}),_vm._v("\n            Vận chuyển\n          ")]),_vm._v(" "),_c("i",{staticClass:"fa fa-arrow-right"}),_vm._v("\n          Đang vận chuyển\n          "),_c("i",{staticClass:"fa fa-arrow-right"}),_vm._v(" "),_c("button",{staticClass:"btn btn-primary-outline",attrs:{type:"button",disabled:"delivered"!=_vm.order.orderStatus},on:{click:function($event){return _vm.updateStatusTo("done")}}},[_c("i",{staticClass:"fa fa-check"}),_vm._v("\n            Hoàn thành\n          ")]),_vm._v(" "),_c("br"),_vm._v(" "),_c("br"),_vm._v(" "),_c("button",{staticClass:"btn btn-danger-outline",attrs:{type:"button",disabled:["cancel","done"].includes(_vm.order.orderStatus)},on:{click:function($event){return _vm.updateStatusTo("cancel")}}},[_c("i",{staticClass:"fa fa-remove"}),_vm._v("\n            Hủy đơn\n          ")])])])])])])},staticRenderFns:[]}},707:function(module,exports){module.exports={render:function(){var _vm=this,_h=_vm.$createElement,_c=_vm._self._c||_h;return _c("div",[_c("Listing",{attrs:{apiService:_vm.cmsUrl,routeDetail:"store_order",title:"StoreOrders",fields:_vm.fieldsDisplay,subTitle:"Listing",sortOrder:_vm.sortOrder,showExport:!0,disabledNew:!0},scopedSlots:_vm._u([{key:"additionalFilter",fn:function(props){}},{key:"addActions",fn:function(props){return[_c("button",{staticClass:"btn btn-primary-outline",attrs:{type:"button","data-toggle":"modal","data-target":"#update-modal"},on:{click:function($event){_vm.selectedOrder=props.props.rowData}}},[_vm._v("Trạng thái")])]}},{key:"additionalButtonHeader",fn:function(props){return[_vm.parent?_c("StorePanel",{attrs:{store:_vm.parent.store||_vm.parent._id}}):_vm._e()]}}])}),_vm._v(" "),_vm.selectedOrder?_c("StoreOrderUpdater",{attrs:{order:_vm.selectedOrder},on:{updated:_vm.orderStatusUpdated}}):_vm._e()],1)},staticRenderFns:[]}}});